// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package main

import (
	"cluster-agent/internal"
	"cluster-agent/internal/api/handlers"
	"cluster-agent/internal/api/middleware"
	"cluster-agent/internal/cache"
	"cluster-agent/internal/config"
	"cluster-agent/internal/consumers"
	"cluster-agent/internal/k8s"
	"cluster-agent/internal/producers"
	"cluster-agent/internal/services"
	"cluster-agent/internal/services/topology"
	"k8s.io/client-go/informers"
	"k8s.io/client-go/kubernetes"
	"k8s.io/client-go/listers/core/v1"
	"k8s.io/client-go/rest"
	cache2 "k8s.io/client-go/tools/cache"
	"time"
)

// Injectors from wire.go:

func InitializeApp() (*internal.App, func(), error) {
	client, err := k8s.NewClient()
	if err != nil {
		return nil, nil, err
	}
	kubernetesInterface := ProvideK8sInterface(client)
	podService := services.NewPodService(kubernetesInterface)
	podHandler := handlers.NewPodHandler(podService)
	deploymentService := services.NewDeploymentService(kubernetesInterface)
	deploymentHandler := handlers.NewDeploymentHandler(deploymentService)
	namespaceService := services.NewNamespaceService(kubernetesInterface)
	namespaceHandler := handlers.NewNamespaceHandler(namespaceService)
	kubernetesServiceService := services.NewServiceService(kubernetesInterface)
	serviceHandler := handlers.NewServiceHandler(kubernetesServiceService)
	nodeService := services.NewNodeService(kubernetesInterface)
	nodeHandler := handlers.NewNodeHandler(nodeService)
	restConfig := ProvideRestConfig(client)
	terminalService := services.NewTerminalService(kubernetesInterface, restConfig)
	terminalHandler := handlers.NewTerminalHandler(terminalService)
	configConfig := config.NewConfig()
	redisClient, cleanup, err := cache.NewRedisClient(configConfig)
	if err != nil {
		return nil, nil, err
	}
	topologyCache := cache.NewTopologyCache(redisClient)
	service := topology.NewTopologyService(topologyCache)
	sharedInformerFactory := ProvideInformerFactory(kubernetesInterface)
	snapshotService := services.NewSnapshotService(sharedInformerFactory)
	topologyHandler := handlers.NewTopologyHandler(service, snapshotService)
	podLogsService := services.NewPodLogsService(kubernetesInterface)
	podLogsHandler := handlers.NewPodLogsHandler(podLogsService)
	configMapService := services.NewConfigMapService(kubernetesInterface)
	configMapHandler := handlers.NewConfigMapHandler(configMapService)
	secretService := services.NewSecretService(kubernetesInterface)
	secretHandler := handlers.NewSecretHandler(secretService)
	ingressService := services.NewIngressService(kubernetesInterface)
	ingressHandler := handlers.NewIngressHandler(ingressService)
	podLister := ProvidePodLister(sharedInformerFactory)
	pvcService := services.NewPVCService(kubernetesInterface, podLister)
	pvcHandler := handlers.NewPvcHandler(pvcService)
	networkInspectorService := services.NewNetworkInspectorService(kubernetesInterface, restConfig)
	networkInspectorHandler := handlers.NewNetworkInspectorHandler(networkInspectorService)
	handlerContainer := handlers.NewHandlerContainer(podHandler, deploymentHandler, namespaceHandler, serviceHandler, nodeHandler, terminalHandler, topologyHandler, podLogsHandler, configMapHandler, secretHandler, ingressHandler, pvcHandler, networkInspectorHandler)
	authorizedMiddleware := middleware.NewAuthorizedMiddleware(configConfig)
	eventBatcher := consumers.NewEventBatcher(configConfig)
	sharedIndexInformer := ProvideEventInformer(sharedInformerFactory)
	eventCollector := producers.NewEventCollector(eventBatcher, sharedIndexInformer)
	app := internal.NewApp(handlerContainer, authorizedMiddleware, eventCollector, eventBatcher, sharedInformerFactory)
	return app, func() {
		cleanup()
	}, nil
}

// wire.go:

func ProvideK8sInterface(client *k8s.Client) kubernetes.Interface {
	return client.GetClientset()
}

func ProvideRestConfig(client *k8s.Client) *rest.Config {
	return client.GetConfig()
}

func ProvideInformerFactory(clientset kubernetes.Interface) informers.SharedInformerFactory {
	return informers.NewSharedInformerFactory(clientset, 12*time.Hour)
}

func ProvideEventInformer(factory informers.SharedInformerFactory) cache2.SharedIndexInformer {
	return factory.Core().V1().Events().Informer()
}

func ProvidePodLister(factory informers.SharedInformerFactory) v1.PodLister {
	return factory.Core().V1().Pods().Lister()
}
